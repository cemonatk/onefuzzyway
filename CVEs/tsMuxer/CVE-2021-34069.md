
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34069

**Description**

Divide-by-zero bug in tsMuxer 2.6.16 allows attackers to cause a Denial of Service (DoS) by running the application with a crafted file.


**References**

CONFIRM:https://github.com/justdan96/tsMuxer/issues/428
MISC:https://github.com/justdan96/tsMuxer/pull/421/files

# Original Report

Hi, please see asan output and poc file below.

Found by **Cem Onat Karagun of Diesec**.

System infoï¼š
```
Ubuntu 21.04
tsMuxeR version git-f6ab2a2
```

To run PoC after unzip:
```
$ ./tsmuxer decoder_poc
```

[decoder_poc.zip](https://github.com/justdan96/tsMuxer/files/6534193/decoder_poc.zip)

### References:
[https://cwe.mitre.org/data/definitions/369.html](https://cwe.mitre.org/data/definitions/369.html)


ASAN output:

```
tsMuxeR version git-f6ab2a2. github.com/justdan96/tsMuxer
AddressSanitizer:DEADLYSIGNAL
=================================================================
==2890753==ERROR: AddressSanitizer: FPE on unknown address 0x000000444db8 (pc 0x000000444db8 bp 0x7ffd085984a0 sp 0x7ffd085983a0 T0)
    #0 0x444db8 in AC3Codec::decodeDtsHdFrame(unsigned char*, unsigned char*) /src/build/../tsMuxer/ac3Codec.cpp:377:65
    #1 0x4478d9 in AC3Codec::decodeFrame(unsigned char*, unsigned char*, int&) /src/build/../tsMuxer/ac3Codec.cpp:428:34
    #2 0x7c61df in SimplePacketizerReader::checkStream(unsigned char*, int, AbstractStreamReader::ContainerType, int, int) /src/build/../tsMuxer/simplePacketizerReader.cpp:257:13
    #3 0x6cf93a in METADemuxer::detectTrackReader(unsigned char*, int, AbstractStreamReader::ContainerType, int, int) /src/build/../tsMuxer/metaDemuxer.cpp:755:20
    #4 0x6c7255 in METADemuxer::DetectStreamReader(BufferedReaderManager&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, bool) /src/build/../tsMuxer/metaDemuxer.cpp:684:35
    #5 0x5df87e in detectStreamReader(char const*, MPLSParser*, bool) /src/build/../tsMuxer/main.cpp:120:34
    #6 0x5efd05 in main /src/build/../tsMuxer/main.cpp:698:17
    #7 0x7f2c99a1a564 in __libc_start_main csu/../csu/libc-start.c:332:16
    #8 0x2ebded in _start (/home/Fuzzer_Instance_29/txmux/tsMuxer/bin/tsMuxeR+0x2ebded)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: FPE /src/build/../tsMuxer/ac3Codec.cpp:377:65 in AC3Codec::decodeDtsHdFrame(unsigned char*, unsigned char*)
==2890753==ABORTING
```

